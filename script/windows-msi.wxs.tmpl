<?xml version='1.0' encoding='utf-8'?>

<?if $(sys.BUILDARCH)="x86"?>
    <?define Program_Files='ProgramFilesFolder'?>
<?elseif $(sys.BUILDARCH)="x64"?>
    <?define Program_Files='ProgramFiles64Folder'?>
<?else?>
    <?error Unsupported value of sys.BUILDARCH=$(sys.BUILDARCH)?>
<?endif?>

<Wix xmlns='http://schemas.microsoft.com/wix/2006/wi'>
  <Product Id='226f7efc-42c3-11eb-ae14-2343dd73c0fb'
    UpgradeCode='c025e3ad-aa90-44c4-9ad1-d28592144b17'
    Name='hub CLI' Version='2.15.0' Manufacturer='GitHub, Inc.'
    Language='1033'>

    <Package Description='hub CLI 2.15.0 installer'
      InstallerVersion='300' Compressed='yes' />
    <Media Id='1' Cabinet='product.cab' EmbedCab='yes' />

    <Directory Id='TARGETDIR' Name='SourceDir'>
      <Directory Id='$(var.Program_Files)'>
        <Directory Id='INSTALLDIR' Name='hub testing' />
      </Directory>
      <Component Id='ENV' Guid='09c5063d-5acf-4e03-ae95-56977e0e50a2'>
          <Environment Id='EnvPath'
            Name='PATH' Value='[BINDIR]'
            Action='set' Permanent='no'
            Part='last' System='yes' />
        </Component>
    </Directory>

    <DirectoryRef Id='INSTALLDIR'>
      <Directory Id='BINDIR' Name='bin'>
        <Component Id='Executables' Guid='86ee1030-42c0-11eb-bf87-4bbb3858b5d2'>
          <File Id='hubEXE' Source='bin\hub.exe' />
        </Component>
      </Directory>

      <Directory Id='SHAREDIR' Name='share'>
        <Directory Id='Share_Doc' Name='doc'>
          <Directory Id='Share_HubDoc' Name='hub-doc'>
            <Component Id='ManPages' Guid='c5450be6-42ce-11eb-b93a-13892dfa22e1'>
              <File Id='ManPages_pullRequest' Source='share\doc\hub-doc\hub-pull-request.1.html' />
            </Component>
          </Directory>
        </Directory>
      </Directory>

      <Component Id='ApplicationFiles' Guid='d236bd92-4222-11eb-ae42-8b954490c2ab'>
        <File Id='Manual' Name='README.txt' Source='README.md' />
        <File Id='License' Name='LICENSE.txt' Source='LICENSE' />
      </Component>
    </DirectoryRef>

    <InstallExecuteSequence>
      <RemoveExistingProducts After='InstallValidate' />
    </InstallExecuteSequence>

    <Feature Id='Complete' Level='1'>
      <ComponentRef Id='Executables' />
      <ComponentRef Id='ENV' />
      <ComponentRef Id='ApplicationFiles' />
      <ComponentRef Id='ManPages' />
    </Feature>

  </Product>
</Wix>
